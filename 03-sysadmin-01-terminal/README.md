# Домашнее задание к занятию "3.1. Работа в терминале, лекция 1"

1. Установите средство виртуализации [Oracle VirtualBox](https://www.virtualbox.org/).

1. Установите средство автоматизации [Hashicorp Vagrant](https://www.vagrantup.com/).

1. В вашем основном окружении подготовьте удобный для дальнейшей работы терминал. Можно предложить:

	* iTerm2 в Mac OS X
	* Windows Terminal в Windows
	* выбрать цветовую схему, размер окна, шрифтов и т.д.
	* почитать о кастомизации PS1/применить при желании.

	Несколько популярных проблем:
	* Добавьте Vagrant в правила исключения перехватывающих трафик для анализа антивирусов, таких как Kaspersky, если у вас возникают связанные с SSL/TLS ошибки,
	* MobaXterm может конфликтовать с Vagrant в Windows,
	* Vagrant плохо работает с директориями с кириллицей (может быть вашей домашней директорией), тогда можно либо изменить [VAGRANT_HOME](https://www.vagrantup.com/docs/other/environmental-variables#vagrant_home), либо создать в системе профиль пользователя с английским именем,
	* VirtualBox конфликтует с Windows Hyper-V и его необходимо [отключить](https://www.vagrantup.com/docs/installation#windows-virtualbox-and-hyper-v),
	* [WSL2](https://docs.microsoft.com/ru-ru/windows/wsl/wsl2-faq#does-wsl-2-use-hyper-v-will-it-be-available-on-windows-10-home) использует Hyper-V, поэтому с ним VirtualBox также несовместим,
	* аппаратная виртуализация (Intel VT-x, AMD-V) должна быть активна в BIOS,
	* в Linux при установке [VirtualBox](https://www.virtualbox.org/wiki/Linux_Downloads) может дополнительно потребоваться пакет `linux-headers-generic` (debian-based) / `kernel-devel` (rhel-based).

1. С помощью базового файла конфигурации запустите Ubuntu 20.04 в VirtualBox посредством Vagrant:

	* Создайте директорию, в которой будут храниться конфигурационные файлы Vagrant. В ней выполните `vagrant init`. Замените содержимое Vagrantfile по умолчанию следующим:

		```bash
		Vagrant.configure("2") do |config|
			config.vm.box = "bento/ubuntu-20.04"
		end
		```

	* Выполнение в этой директории `vagrant up` установит провайдер VirtualBox для Vagrant, скачает необходимый образ и запустит виртуальную машину.

	* `vagrant suspend` выключит виртуальную машину с сохранением ее состояния (т.е., при следующем `vagrant up` будут запущены все процессы внутри, которые работали на момент вызова suspend), `vagrant halt` выключит виртуальную машину штатным образом.

1. Ознакомьтесь с графическим интерфейсом VirtualBox, посмотрите как выглядит виртуальная машина, которую создал для вас Vagrant, какие аппаратные ресурсы ей выделены. Какие ресурсы выделены по-умолчанию?

1. Ознакомьтесь с возможностями конфигурации VirtualBox через Vagrantfile: [документация](https://www.vagrantup.com/docs/providers/virtualbox/configuration.html). Как добавить оперативной памяти или ресурсов процессора виртуальной машине?

1. Команда `vagrant ssh` из директории, в которой содержится Vagrantfile, позволит вам оказаться внутри виртуальной машины без каких-либо дополнительных настроек. Попрактикуйтесь в выполнении обсуждаемых команд в терминале Ubuntu.

1. Ознакомиться с разделами `man bash`, почитать о настройках самого bash:
    * какой переменной можно задать длину журнала `history`, и на какой строчке manual это описывается?
	  ###Ответ: переменные HISTSIZE и HISTFILESIZE. Это 698-я и 687-я строки в man bash
	  `HISTSIZE=1000`
	  
	  `HISTFILESIZE=2000`
    * что делает директива `ignoreboth` в bash?
	  ###Ответ: Директива `ignoreboth` - это одно из 4-х значений переменной HISTCONTROL. Позволяет не записывать в историю команд команды, начинающиеся с пробела и команды-дубликаты по отношению к последней введенной команде.
	  `HISTCONTROL=ignoreboth`
1. В каких сценариях использования применимы скобки `{}` и на какой строчке `man bash` это описано?
   ###Ответ: В фигурных скобках записывается последовательность значений-строк, подставляемых в команду bash при раскрытии этих скобок. Т.е. их можно назвать сокращениями для краткого написания повторяющихся команд bash. Это описано на 865, 880, 889 строках man bash. 
1. Основываясь на предыдущем вопросе, как создать однократным вызовом `touch` 100000 файлов? А получилось ли создать 300000?
   ###Ответ:
   `touch file_{1..100000}` -это создаст в текущей директории 100000 файлов с именами file_1, file_2, ..., file_100000
   
   `touch file_{1..300000}` -это создаст в текущей директории 300000 файлов с именами file_1, file_2, ..., file_300000. И только если хватит inodes в разделе. Лучше не создавать так много файлов в одной директории.
1. В man bash поищите по `/\[\[`. Что делает конструкция `[[ -d /tmp ]]`
   ###Ответ: В двойных квадратных скобках записывается выражение, которое принимает значение либо 1 (Истина), либо 0 (Ложь). Это используется в условных операторах if и не только. Конкретно выражение `[[ -d /tmp ]]` вернет 1 (Истина), т.к. проверяется существование директории `/tmp`. Все описано на 1507-й строке man bash.     
1. Основываясь на знаниях о просмотре текущих (например, PATH) и установке новых переменных; командах, которые мы рассматривали, добейтесь в выводе type -a bash в виртуальной машине наличия первым пунктом в списке:

	```bash
	bash is /tmp/new_path_directory/bash
	bash is /usr/local/bin/bash
	bash is /bin/bash
	```

	(прочие строки могут отличаться содержимым и порядком)
    ###Ответ: 
    ```
   # mkdir /tmp/w-awank
   # cp /bin/bash /tmp/w-awank/
   # cp /bin/bash /usr/local/bin/
   # PATH=/tmp/w-awank:$PATH
   # echo $PATH
   /tmp/w-awank:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
   # PATH=/tmp/w-awank:/usr/local/sbin:/usr/local/bin:/usr/sbin:/bin:/sbin:/usr/bin:/usr/games:/usr/local/games:/snap/bin
   # type -a bash
   bash is /tmp/w-awank/bash
   bash is /usr/local/bin/bash
   bash is /bin/bash
   bash is /usr/bin/bash
    ```

1. Чем отличается планирование команд с помощью `batch` и `at`?
   ###Ответ: команда `at` используется для назначения одноразового задания на заданное время, а команда `batch` — для назначения одноразовых задач, которые должны выполняться, когда загрузка системы становится меньше 1,5. Эту инфу я взял из строк 19 и 26 man batch.

1. Завершите работу виртуальной машины чтобы не расходовать ресурсы компьютера и/или батарею ноутбука.
   ###Ответ: `vagrant halt`

 
 ---

### Как оформить ДЗ?

Домашнее задание выполните в файле readme.md в github репозитории. В личном кабинете отправьте на проверку ссылку на .md-файл в вашем репозитории.

Также вы можете выполнить задание в [Google Docs](https://docs.google.com/document/u/0/?tgif=d) и отправить в личном кабинете на проверку ссылку на ваш документ.
Название файла Google Docs должно содержать номер лекции и фамилию студента. Пример названия: "1.1. Введение в DevOps — Сусанна Алиева"
Перед тем как выслать ссылку, убедитесь, что ее содержимое не является приватным (открыто на комментирование всем, у кого есть ссылка). 
Если необходимо прикрепить дополнительные ссылки, просто добавьте их в свой Google Docs.

Любые вопросы по решению задач задавайте в чате Slack.

---